<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>

<title>How to write functions in R</title>

<script type="text/javascript">
window.onload = function() {
  var imgs = document.getElementsByTagName('img'), i, img;
  for (i = 0; i < imgs.length; i++) {
    img = imgs[i];
    // center an image if it is the only element of its parent
    if (img.parentElement.childElementCount === 1)
      img.parentElement.style.textAlign = 'center';
  }
};
</script>





<style type="text/css">
body, td {
   font-family: sans-serif;
   background-color: white;
   font-size: 13px;
}

body {
  max-width: 800px;
  margin: auto;
  padding: 1em;
  line-height: 20px;
}

tt, code, pre {
   font-family: 'DejaVu Sans Mono', 'Droid Sans Mono', 'Lucida Console', Consolas, Monaco, monospace;
}

h1 {
   font-size:2.2em;
}

h2 {
   font-size:1.8em;
}

h3 {
   font-size:1.4em;
}

h4 {
   font-size:1.0em;
}

h5 {
   font-size:0.9em;
}

h6 {
   font-size:0.8em;
}

a:visited {
   color: rgb(50%, 0%, 50%);
}

pre, img {
  max-width: 100%;
}
pre {
  overflow-x: auto;
}
pre code {
   display: block; padding: 0.5em;
}

code {
  font-size: 92%;
  border: 1px solid #ccc;
}

code[class] {
  background-color: #F8F8F8;
}

table, td, th {
  border: none;
}

blockquote {
   color:#666666;
   margin:0;
   padding-left: 1em;
   border-left: 0.5em #EEE solid;
}

hr {
   height: 0px;
   border-bottom: none;
   border-top-width: thin;
   border-top-style: dotted;
   border-top-color: #999999;
}

@media print {
   * {
      background: transparent !important;
      color: black !important;
      filter:none !important;
      -ms-filter: none !important;
   }

   body {
      font-size:12pt;
      max-width:100%;
   }

   a, a:visited {
      text-decoration: underline;
   }

   hr {
      visibility: hidden;
      page-break-before: always;
   }

   pre, blockquote {
      padding-right: 1em;
      page-break-inside: avoid;
   }

   tr, img {
      page-break-inside: avoid;
   }

   img {
      max-width: 100% !important;
   }

   @page :left {
      margin: 15mm 20mm 15mm 10mm;
   }

   @page :right {
      margin: 15mm 10mm 15mm 20mm;
   }

   p, h2, h3 {
      orphans: 3; widows: 3;
   }

   h2, h3 {
      page-break-after: avoid;
   }
}
</style>



</head>

<body>
<h1>How to write functions in R</h1>

<p>Functions allow you to simplify complex tasks, which is especially useful if you need to run a task multiple times. R has many, many functions built in. R packages (or libraries) are collections of functions that help further simplify tasks. As tasks become more complex, however, it is inevitable that you will have to customize your own or existing functions to suit your needs.</p>

<h2>Running a built-in function</h2>

<p>Consider a vector, x, that contains 6 numbers: 1, 1, 2, 3, 5, and 8. If you wanted to add up all of the elements in x, you could either add elements individually, as you would on a calculator, or simply use the built-in â€œsumâ€ function. To run a function, you type the name of the function and then parentheses enclosing the object that you wish to run the function on.</p>

<pre><code>1+1+2+3+5+8
x &lt;- c(1,1,2,3,5,8)
sum(x)
</code></pre>

<p><em>Note: c(), above, is the &ldquo;combine&rdquo; function, which combines elements into a vector. The arrow, &ldquo;&lt;-&rdquo;, assigns a name to an object so that the object may be stored in memory. This allows you to use the object in the future without having to recreate it.</em></p>

<p>##Writing simple functions
Writing your own functions is easy, as long as you follow the correct syntax. The basic structure is:</p>

<pre><code>theNameOfMyFunction &lt;- function(objectToComputeFunctionFor) {
    What you would like to happen when you run your function
}
</code></pre>

<p><em>Note: The curly brackets above are only necessary if your function is more  than one line. If your function is one line you do not need to include them.</em>
Letâ€™s write a function that adds 1 to every number in our vector x above.</p>

<pre><code>addOneFun &lt;- function (x) x + 1
</code></pre>

<p>Which could also be written as:</p>

<pre><code>addOneFun &lt;- function(x){
    x+1
}
</code></pre>

<p>You then can run the addOneFun function by typing:</p>

<pre><code>addOneFun(x)
</code></pre>

<p>Writing and running your own functions is really as simple as that. A couple of tricks along the way though:</p>

<p>If you assign a name to function output, it is necessary to tell R to return the output. For example, the following function will not return any information:</p>

<pre><code>addOneFun &lt;- function(x){
    xPlusOne &lt;- x+1
}
</code></pre>

<p>When assigning names, you need to add â€œreturnâ€ to show the results of the function:</p>

<pre><code>addOneFun &lt;- function(x){
    xPlusOne &lt;- x+1
    return(xPlusOne)
}
</code></pre>

<p>Additionally, R will not automatically store intermediate results. Letâ€™s consider a function that multiplies the â€œplus oneâ€ by two:</p>

<pre><code>addOneTimesTwoFun &lt;- function(x){
    xPlusOne &lt;- x+1
    xPlusOneTimesTwo &lt;- xPlusOne*2
    return(xPlusOneTimesTwo)
}
</code></pre>

<p>xPlusOne will be nowhere to be found in your environment! This may seem like a hiccup, but itâ€™s actually very useful when you are running big datasets and need to conserve your systems memory. If you do want to see the intermediate results (for example while debugging a formula), you could assign with the symbol â€œ&lt;&lt;-â€œ to store the object on your workspace:</p>

<pre><code>addOneTimesTwoFun &lt;- function(x){
    xPlusOne &lt;&lt;- x+1
    xPlusOneTimesTwo &lt;- xPlusOne*2
    return(xPlusOneTimesTwo)
}
</code></pre>

<h2>Some best manangement practices for writing functions</h2>

<p><strong>Make your code readable!</strong> Itâ€™s highly unlikely that you will get hit in the head with a meteorite, but there is a non-zero probability that this will occur. As this is the case, youâ€™ll undoubtedly want to leave your code behind as your legacy. Make sure to either name variables in such a way that future generations can understand what youâ€™ve done, or provided comments (â€œ#â€) to your script to explain each step. I feel Iâ€™ve done well with my naming, but if I wanted to be sure, I could write the function as:</p>

<pre><code>addOneTimesTwoFun &lt;- function(x){
    # Add one to x:
        xPlusOne &lt;- x+1
    # Multiple the new x+1 vector by two:
        xPlusOneTimesTwo &lt;- xPlusOne*2
    # Provide output:
        return(xPlusOneTimesTwo)
}
</code></pre>

<p><strong>Break complex functions into multiple steps.</strong> Functions should be kept short and understandable, when possible. This makes it easier to understand each step in a process and easier to test for potential problems that may arise. For complex functions, nest preliminary steps within the large function. While our &ldquo;addOneTimesTwoFun&rdquo; is understandable, we could break this function into multiple steps as:</p>

<pre><code>addOneFun &lt;- function(x) x + 1

addOneTimesTwoFun &lt;- function(x){
    xPlusOne &lt;- addOneFun(x)
    xPlusOneTimesTwo &lt;- xPlusOne*2
    return(xPlusOneTimesTwo)
}
</code></pre>

<p><strong>Make sure your function does what you think that it does.</strong> It can be unfortunately easy to construct complex functions that do not perform their task as you intended. For complex functions, it&#39;s necessary to test your function. To do so, create test data that will demonstrate whether your function works. Prior to running your test, be sure to have a clear expectation of what the results should look like. An example with our addOneFun function:</p>

<pre><code>testX &lt;- c(0,1,2)

testXplusOne &lt;- addOneFun(testX)

testX

testX-1
</code></pre>

</body>

</html>
